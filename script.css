const display = document.getElementById('display');
let displayValue = '0';

function clearDisplay() {
    displayValue = '0';
    updateDisplay();
}

function appendToDisplay(value) {
    const lastChar = displayValue.slice(-1);

    // Prevent appending an operator if the display is empty or contains only a single zero
    if (['+', '-', '*', '/'].includes(value) && (displayValue === '' || displayValue === '0')) {
        return;
    }

    // Prevent multiple consecutive operators
    if (['+', '-', '*', '/'].includes(value) && ['+', '-', '*', '/'].includes(lastChar)) {
        return;
    }

    if (value === '+/-') {
        // Toggle the sign of the number
        displayValue = displayValue.startsWith('-') ? displayValue.slice(1) : '-' + displayValue;
    } else if (value === '%') {
        // Calculate the percentage
        displayValue = (parseFloat(displayValue) / 100).toString();
    } else {
        if (displayValue === '0') {
            displayValue = value;
        } else {
            displayValue += value;
        }
    }
    updateDisplay();
}

function backspace() {
    displayValue = displayValue.slice(0, -1);
    if (displayValue === '') {
        displayValue = '0';
    }
    updateDisplay();
}

function calculate() {
    try {
        // Evaluate the expression and display the result
        displayValue = eval(displayValue).toString();
    } catch (error) {
        // If there's an error, display "Error" on the screen
        displayValue = 'Error';
    }
    updateDisplay();
}

function updateDisplay() {
    const display = document.getElementById('display');
    display.innerText = displayValue;

    // Adjust font size to fit the display
    let fontSize = 70; // Starting font size
    display.style.fontSize = fontSize + 'px';

    while (display.scrollWidth > display.clientWidth && fontSize > 10) {
        fontSize -= 1;
        display.style.fontSize = fontSize + 'px';
    }
}
